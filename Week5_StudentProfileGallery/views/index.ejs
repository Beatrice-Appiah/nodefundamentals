<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Gallery</title>
    <!-- Link to your external CSS file -->
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <h1 class="title"><u>STUDENT PROFILE GALLERY</u></h1>
    <br>
    <a href="/welcome" class="btn">‚Üê Go to Home</a>

    <a class='btn' href="/new">Add New Student</a>

    <div class="gallery">
        <% if (students.length === 0) { %>
            <p style="grid-column: 1/-1; text-align: center;">No Students Added Yet</p>
        <% } else { %>
            
            <% students.forEach(student => { %>
                <div class="card">
                    <!-- 1. Profile Picture -->
                    <img src="<%= student.photo %>" 
                         alt="<%= student.name %>" 
                         onerror="this.src='https://via.placeholder.com/150?text=No+Img'">

                    <!-- 2. Student Info -->
                    <div>
                        <h3><%= student.name %></h3>
                        <p><strong>Age:</strong> <%= student.age %></p>
                        <p><strong>Course:</strong> <%= student.course %></p>
                    </div>

                    <!-- 3. Actions (Edit & Delete) -->
                    <div class="card-actions">
                        <a href="/edit/<%= student._id %>" class="btn-edit">Edit</a>
                        <button class="btn-delete" onclick="deleteStudent('<%= student._id %>')">Delete</button>
                    </div>
                </div>
            <% }) %>

        <% } %>
    </div>
  
    <script>
        async function deleteStudent(id) {
            if (confirm('Are you sure you want to delete this student?')) {
                try {
                    const response = await fetch(`/students/${id}`, {
                        method: 'DELETE'
                    });

                    if (response.ok) {
                        window.location.reload(); 
                    } else {
                        alert('Failed to delete student');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    alert('Error deleting student');
                }
            }
        }
    </script>
</body>
</html>